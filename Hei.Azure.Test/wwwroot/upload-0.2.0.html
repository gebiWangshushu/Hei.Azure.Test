<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Upload</title>
</head>

<body>
    <div>
        <div>
            <div>
                <div>
                    <div>
                        <label>分片大小(Mb)：</label><input type="text" value="1.0" id="blockSize" />
                        <br />
                        <label>
                            <span class="btn btn-primary">
                                <input type="file" style="" name="file" id="FileInput" />
                            </span>
                        </label>
                        <input type="hidden" readonly="" id="BrowseInput" />
                    </div>
                </div>
                <div>
                    <div>
                        <button type="button" value="Upload to Blob" class="btn btn-success" id="UploadBlob"
                                onclick="uploadBlob()">
                            Upload to Blob
                        </button>
                    </div>
                </div>
                <div class="form-group hidden" id="uploadProgressBarContainer">
                    Uploading...
                    <div>
                        <div role="progressbar" id="uploadProgressBar" aria-valuenow="60" aria-valuemin="0"
                             aria-valuemax="100" style="width: 0%;">0%</div>
                        <div id="uploadtime"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- <script src="azurestorage/bundle/azure-storage.blob.js"></script> -->
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.6.0.min.js"></script>

    <!-- <script src="slzstorage/0.1.0/slz.storage.js"></script> -->
    <!--<script src="slzstorage/0.1.0/slz.storage.mini.js"></script>-->

    <script src="slzstorage/0.2.0/slz.storage.js"></script>

    <!-- <script src="https://sammci.blob.core.chinacloudapi.cn/wwwstatic/js/slzstorage/0.1.0/slz.storage.js"></script> -->
    <!-- <script src="https://sammci.blob.core.chinacloudapi.cn/wwwstatic/js/slzstorage/0.1.0/slz.storage.mini.js"></script> -->

    <script type="text/javascript">

        // function processCallback(process)
        // {
        //     var fileMB = (file.size / (1024 * 1024)).toFixed(2);
        //             var oldText = $("#uploadtime").html() + "</br>";
        //             $("#uploadtime").html(`${oldText}文件:${file.name}，大小：${fileMB}(MB)，切片大小:${blockSize}(MB)  上传耗时：${duration}(S)；速率-->${v} MB/s`);
        // }

        //function uploadBlob() {

        //    var file = $('#FileInput').get(0).files[0];

        //    var storage = new SlzStorage({
        //        sasGenerateUrl: "https://api-ci.siluzan.com/cutapi/v1/azure/storage/generatesas",
        //        sasAccount: "tiktokapi",
        //    });

        //    storage.uoload(file, function (result, response) {
        //        console.info("上传成功回调")
        //         console.info(response.data)
        //         console.info(response.data.resourceUrl)
        //    }, function (error) {
        //        console.info("上传失败回调")
        //        console.info(error);
        //    }, function (process) {
        //        console.info("上传进度条更新回调:"+process)
        //    });
        //}

        async function uploadBlob() {
            var file = $('#FileInput').get(0).files[0];

            var storage = new SlzStorage({
                sasGenerateUrl: "https://api-ci.siluzan.com/cutapi/v1/azure/storage/generatesas",
                sasAccount: "cutapi",
            });

            var result = await storage.uoloadP(file).catch((err) => {
                console.info(err);
            });

            console.info(result);
        }

        new Promise(function (resolve, reject) {
            console.log(1111);
            resolve(22221);
        }).then(function (value) {
            console.log(value);
            return 33332;
        }).then(function (value) {
            console.log(value);
            throw "An error";
        }).catch(function (err) {
            console.log(err);
        });
    </script>
</body>
</html>