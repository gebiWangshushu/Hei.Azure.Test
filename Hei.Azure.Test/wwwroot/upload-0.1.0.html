<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Upload</title>
</head>

<body>
    <div>
        <div>
            <div>
                <div>
                    <div>
                        <label>分片大小(Mb)：</label><input type="text" value="1.0" id="blockSize" />
                        <br />
                        <label>
                            <span class="btn btn-primary">
                                <input type="file" style="" name="file" id="FileInput" />
                            </span>
                        </label>
                        <input type="hidden" readonly="" id="BrowseInput" />
                    </div>
                </div>
                <div>
                    <div>
                        <button type="button" value="Upload to Blob" class="btn btn-success" id="UploadBlob"
                                onclick="uploadBlob()">
                            Upload to Blob
                        </button>
                    </div>
                </div>
                <div class="form-group hidden" id="uploadProgressBarContainer">
                    Uploading...
                    <div>
                        <div role="progressbar" id="uploadProgressBar" aria-valuenow="60" aria-valuemin="0"
                             aria-valuemax="100" style="width: 0%;">0%</div>
                        <div id="uploadtime"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- <script src="azurestorage/bundle/azure-storage.blob.js"></script> -->
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.6.0.min.js"></script>

    <!--  <script src="slzstorage/0.1.0/slz.storage.js"></script>-->
    <script src="slzstorage/0.1.0/slz.storage.mini.js"></script>

    <!-- <script src="https://sammci.blob.core.chinacloudapi.cn/wwwstatic/js/slzstorage/0.1.0/slz.storage.js"></script> -->
    <!-- <script src="https://sammci.blob.core.chinacloudapi.cn/wwwstatic/js/slzstorage/0.1.0/slz.storage.mini.js"></script> -->

    <script type="text/javascript">

        // function processCallback(process)
        // {
        //     var fileMB = (file.size / (1024 * 1024)).toFixed(2);
        //             var oldText = $("#uploadtime").html() + "</br>";
        //             $("#uploadtime").html(`${oldText}文件:${file.name}，大小：${fileMB}(MB)，切片大小:${blockSize}(MB)  上传耗时：${duration}(S)；速率-->${v} MB/s`);
        // }

        function download(href, title) {
            const a = document.createElement('a');
            a.setAttribute('href', href);
            a.setAttribute('download', title);
            a.click();
        }

        download(url, 'lzwme-gravatar');

        function uploadBlob() {

            var url ="https://sucaici.blob.core.chinacloudapi.cn/be733c60-50b5-49d7-9567-f70947ee988f/33b0e510-7469-42cf-b795-36a752002798.mp4?sv=2021-06-08&se=2022-06-16T19%3A06%3A59Z&sr=b&sp=r&sig=0c9dYrIvCVgx%2Fo7i3lsInBfnDtQ6YKIggNF9W9082H4%3D"

            //download(url, 'lzwme-gravatar');
            download("https://heinersucai.blob.core.chinacloudapi.cn/vdc0245823/008a6513-2f0c-40d1-adf5-d4afb93b5225.mp4", 'lzwme-gravatar');

            //axios.get("https://sucaici.blob.core.chinacloudapi.cn/be733c60-50b5-49d7-9567-f70947ee988f/33b0e510-7469-42cf-b795-36a752002798.mp4?sv=2021-06-08&se=2022-06-16T19%3A06%3A59Z&sr=b&sp=r&sig=0c9dYrIvCVgx%2Fo7i3lsInBfnDtQ6YKIggNF9W9082H4%3D", { params: {}, responseType: 'blob' })
            //    .then((res) => { })
            //    .catch((err) => { })

            var file = $('#FileInput').get(0).files[0];

            var storage = new SlzStorage({
                sasGenerateUrl: "https://api-ci.siluzan.com/cutapi/v1/azure/storage/generatesas",
                sasAccount: "tiktokapi",
                sasHeader: {
                    "Authorization": "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6Ikx5ZEIyVHJwMzZzOGtJNE5BNWc3WWNvMnROdyIsInR5cCI6IkpXVCIsIng1dCI6Ikx5ZEIyVHJwMzZzOGtJNE5BNWc3WWNvMnROdyJ9.eyJuYmYiOjE2NTMwMTg3NDgsImV4cCI6MTY1MzA1NDc0OCwiaXNzIjoiaHR0cHM6Ly9zc28tY2kuc2lsdXphbi5jb20iLCJhdWQiOlsiaHR0cHM6Ly9zc28tY2kuc2lsdXphbi5jb20vcmVzb3VyY2VzIiwiYXBpMSIsImFwaS11c3NpdGVtYW4iLCJhcGktZmFjZWJvb2siLCJhcGkteW91dHViZSIsImFwaS1nb29nbGUiLCJhcGktZG91eWluIiwiYXBpLWt1YWlzaG91IiwiYXBpLXRpa3RvayIsImFwaS1jdXQiXSwiY2xpZW50X2lkIjoid3d3Iiwic3ViIjoiOGZkNGQzZDMtMGRlNS00YzQ2LWE0NDAtNDdiMWExNDYxZDBkIiwiYXV0aF90aW1lIjoxNjUzMDE4NzQ4LCJpZHAiOiJsb2NhbCIsImVtYWlsIjoic2lAY2d5LmNuIiwibmFtZSI6IuWtn-m-mSIsInJvbGUiOiJTdGV3YXJkSW5kaXZpZHVhbCIsInNjb3BlIjpbIm9wZW5pZCIsInByb2ZpbGUiLCJhcGkxIiwiYXBpLXVzc2l0ZW1hbiIsImFwaS1mYWNlYm9vayIsImFwaS15b3V0dWJlIiwiYXBpLWdvb2dsZSIsImFwaS1kb3V5aW4iLCJhcGkta3VhaXNob3UiLCJhcGktdGlrdG9rIiwiY3V0YXBpLnJ3IiwiYXp1cmVhcGkucnciLCJvZmZsaW5lX2FjY2VzcyJdLCJhbXIiOlsicHdkIl19.qUGTQl9GDCpAY1M8_qwEY3q8II_AjVrOmvNc9sPY_SJsvPa1XrsQaEamjQWUbxsztXKzJhr7hit7xjSWzQp-Ya1wk4YjVbOs7YYi4jISZsNJzHcV2h_B9HFov01jLzYVO_bsfYICC9Z5gNVZnglZY4c6j-XPbw_Ds9QTkoVpbC_UjxU3C1J7IPYkixd3e-vyQDix3wuKnzG8X5_awuKUtRfd-VMpqhcpTEYevVW1IDW21gkRJk68UyAZlbtdJrPr9vQ-pwwoFSPZ2knXST4sMFj-FoBr9108048Qt0iHUXHyBMi_LueypE0mhnOVDmLOBfAYiqtSVpeO4umzOzE5ow"
                }
            });

            storage.uoload(file, function (result, response) {
                console.info("上传成功回调")
                console.info(response.data)
                console.info(response.data.resourceUrl)
            }, function (error) {
                console.info("上传失败回调")
                console.info(error);
            }, function (process) {
                console.info("上传进度条更新回调:" + process)
            });
        }
    </script>
</body>
</html>